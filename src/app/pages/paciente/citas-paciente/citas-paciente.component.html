<p-toast></p-toast>

<div class="citas-paciente-container">
  <h2>Mis citas</h2>

  <p-table
    [value]="citas"
    [paginator]="true"
    [rows]="5"
    responsiveLayout="scroll"
    *ngIf="citas.length"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Fecha</th>
        <th>Hora</th>
        <th>Especialidad</th>
        <th>Lugar</th>
        <th>Estado</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-cita>
      <tr>
        <td>{{ cita.horario | date : "shortDate" }}</td>
        <td>{{ cita.horario | date : "shortTime" }}</td>
        <td>{{ cita.tipo }}</td>
        <td>{{ cita.lugar || "-" }}</td>
        <td>
          <span class="estado pendiente">Pendiente</span>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <div class="actions">
    <p-button
      label="Nueva cita"
      icon="pi pi-plus"
      (click)="showDialog = true"
      styleClass="p-button-success"
    ></p-button>

    <p-button
      label="Ver expediente"
      icon="pi pi-folder-open"
      styleClass="p-button-secondary"
      (click)="goToExpediente()"
    ></p-button>

    <p-button
      label="Cerrar Sesión"
      icon="pi pi-sign-out"
      class="p-button-text"
      type="button"
      (click)="onCerrarSesion()"
    ></p-button>
  </div>

  <p-dialog
    class="dialog"
    header="Nueva cita"
    [(visible)]="showDialog"
    [modal]="true"
    [style]="{ width: '450px' }"
    [baseZIndex]="10000"
    [closable]="false"
  >
    <p-iftalabel class="p-field">
      <label for="tipo">Especialidad</label>
      <input
        id="tipo"
        type="text"
        pInputText
        class="p-inputtext p-component"
        [(ngModel)]="nuevaCita.tipo"
        placeholder="Ingresa la especialidad"
      />
    </p-iftalabel>

    <p-iftalabel class="p-field">
      <input
        id="consultorio"
        type="number"
        class="p-inputtext p-component"
        pInputText
        [(ngModel)]="nuevaCita.id_consultorio"
        placeholder="Ingresa el ID del consultorio"
        min="1"
      />
      <label for="consultorio">Consultorio</label>
    </p-iftalabel>

    <p-iftalabel class="p-field">
      <input
        id="medico"
        class="p-inputtext p-component"
        type="number"
        pInputText
        [(ngModel)]="nuevaCita.id_medico"
        placeholder="Ingresa el ID del médico"
        min="1"
      />
      <label for="medico">Médico</label>
    </p-iftalabel>

    <p-iftalabel class="p-field">
      <label for="horario">Horario</label>
      <input
        id="horario"
        name="horario"
        class="p-inputtext p-component"
        type="datetime-local"
        pInputText
        [(ngModel)]="nuevaCita.horario"
        placeholder=" "
      />
    </p-iftalabel>

    <ng-template pTemplate="footer">
      <div class="p-d-flex p-jc-between" style="gap: 1rem">
        <p-button
          label="Cancelar"
          icon="pi pi-times"
          class="p-button-text"
          (click)="showDialog = false"
        ></p-button>

        <p-button
          label="Guardar"
          icon="pi pi-check"
          class="p-button-primary"
          (click)="guardarCita()"
        ></p-button>
      </div>
    </ng-template>
  </p-dialog>
</div>
